<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€å¹´çº§è‹±è¯­å•è¯æ¶ˆæ¶ˆä¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a8fe3 0%, #5ce1e6 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            color: #333;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            text-align: center;
        }
        
        header {
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: #ff6b6b;
            text-shadow: 1px 1px 0 #ffd166;
        }
        
        .subtitle {
            font-size: 1rem;
            color: #118ab2;
            margin-bottom: 10px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.95);
            padding: 12px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }
        
        .info-label {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 3px;
        }
        
        .info-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #ef476f;
        }
        
        .grade-badge {
            background: #06d6a0;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-weight: bold;
            margin-top: 8px;
            display: inline-block;
            font-size: 0.9rem;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 15px;
            width: 100%;
        }
        
        .card {
            aspect-ratio: 1/1;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            position: relative;
            overflow: hidden;
            min-height: 70px;
        }
        
        .card:active {
            transform: scale(0.95);
        }
        
        .card.selected {
            box-shadow: 0 0 0 3px #ffd166, 0 0 10px #ff9e6d;
        }
        
        .card.matched {
            opacity: 0.5;
            transform: scale(0.92);
            cursor: default;
        }
        
        .card-image {
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .card-word {
            font-size: 0.9rem;
            font-weight: bold;
            text-align: center;
            line-height: 1.2;
        }
        
        .card-type-english {
            background: linear-gradient(135deg, #ffd166 0%, #ff9e6d 100%);
        }
        
        .card-type-image {
            background: linear-gradient(135deg, #a8e6cf 0%, #5ce1e6 100%);
        }
        
        .sound-icon {
            position: absolute;
            top: 3px;
            right: 3px;
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            background: #ffd166;
            color: #333;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            flex: 1;
            min-width: 120px;
        }
        
        button:active {
            transform: translateY(2px);
        }
        
        #restart {
            background: #ef476f;
            color: white;
        }
        
        #nextLevel {
            background: #06d6a0;
            color: white;
            display: none;
        }
        
        #continueGame {
            background: #118ab2;
            color: white;
            display: none;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            text-align: left;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .instructions h3 {
            margin-bottom: 8px;
            color: #118ab2;
            font-size: 1.1rem;
        }
        
        .instructions p {
            margin-bottom: 6px;
            line-height: 1.4;
            font-size: 0.9rem;
        }
        
        .daily-stats {
            background: rgba(255, 255, 255, 0.95);
            padding: 12px;
            border-radius: 12px;
            margin-top: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
        }
        
        .stats-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #118ab2;
            text-align: center;
            font-size: 1rem;
        }
        
        .stats-content {
            display: flex;
            justify-content: space-around;
            font-size: 0.9rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 15px;
            background: #e0e0e0;
            border-radius: 8px;
            margin: 8px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #06d6a0, #4cc9f0);
            border-radius: 8px;
            transition: width 0.5s;
        }
        
        .timer-warning {
            color: #ef476f;
            animation: pulse 1s infinite;
        }
        
        .completion-message {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .game-over-message {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            margin: 15px 0;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .continue-count {
            background: #ffd166;
            color: #333;
            padding: 5px 10px;
            border-radius: 10px;
            font-weight: bold;
            margin: 10px 0;
            display: inline-block;
        }
        
        /* ç¤¼èŠ±æ•ˆæœ */
        .firework {
            position: fixed;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1000;
        }
        
        @keyframes firework {
            0% {
                transform: translate(var(--x), var(--y));
                width: 4px;
                height: 4px;
                opacity: 1;
            }
            50% {
                width: 2px;
                height: 2px;
                opacity: 1;
            }
            100% {
                width: 150px;
                height: 150px;
                opacity: 0;
                transform: translate(var(--x), var(--y)) scale(0);
            }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ä¸€å¹´çº§è‹±è¯­å•è¯æ¶ˆæ¶ˆä¹</h1>
            <p class="subtitle">å­¦ä¹ ä¸€å¹´çº§å¸¸è§è‹±è¯­å•è¯ï¼</p>
            <div class="grade-badge">ä¸€å¹´çº§</div>
        </header>
        
        <div class="game-info">
            <div class="info-item">
                <div class="info-label">æ—¶é—´</div>
                <div class="info-value" id="timer">60</div>
            </div>
            <div class="info-item">
                <div class="info-label">åˆ†æ•°</div>
                <div class="info-value" id="score">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">å…³å¡</div>
                <div class="info-value" id="level">1</div>
            </div>
        </div>
        
        <div id="completionMessage" class="completion-message" style="display: none;">
            <h2>æ­å–œï¼ä½ å·²ç»å­¦å®Œäº†æ‰€æœ‰å•è¯ï¼</h2>
            <p>ä½ å·²æŒæ¡ <span id="totalWordsLearned">0</span> ä¸ªå•è¯ï¼</p>
            <button id="resetWords">é‡æ–°å¼€å§‹å­¦ä¹ </button>
        </div>
        
        <div id="gameOverMessage" class="game-over-message">
            <h2>æ—¶é—´åˆ°ï¼æ¸¸æˆç»“æŸ</h2>
            <p>ä½ çš„å¾—åˆ†: <span id="finalScore">0</span> åˆ†</p>
            <p>å‰©ä½™ç»§ç»­æ¸¸æˆæ¬¡æ•°: <span id="continueCount">2</span> æ¬¡</p>
            <div class="controls">
                <button id="continueGame">ç»§ç»­æ¸¸æˆ</button>
                <button id="restartFromGameOver">é‡æ–°å¼€å§‹</button>
            </div>
        </div>
        
        <div class="game-board" id="gameBoard">
            <!-- å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <div class="controls">
            <button id="start">å¼€å§‹æ¸¸æˆ</button>
            <button id="nextLevel">ä¸‹ä¸€å…³</button>
            <button id="restart">é‡æ–°å¼€å§‹</button>
        </div>
        
        <div class="instructions">
            <h3>æ¸¸æˆè¯´æ˜ï¼š</h3>
            <p>1. ç‚¹å‡»å¡ç‰‡å¯ä»¥å¬åˆ°å•è¯å‘éŸ³</p>
            <p>2. ç‚¹å‡»ä¸€ä¸ªè‹±è¯­å•è¯ï¼Œç„¶åç‚¹å‡»å¯¹åº”çš„å›¾ç‰‡è¿›è¡ŒåŒ¹é…</p>
            <p>3. åŒ¹é…æˆåŠŸåˆ™æ¶ˆé™¤ï¼ŒåŒ¹é…é”™è¯¯éœ€è¦é‡æ–°é€‰æ‹©</p>
            <p>4. åœ¨60ç§’å†…åŒ¹é…æ‰€æœ‰å•è¯å¯¹å³å¯è¿›å…¥ä¸‹ä¸€å…³</p>
            <p>5. <strong>æ¯å…³éƒ½æ˜¯æ–°å•è¯ï¼Œä¸ä¼šé‡å¤ï¼</strong></p>
            <p>6. æ—¶é—´ç”¨å®Œåæœ‰2æ¬¡ç»§ç»­æ¸¸æˆçš„æœºä¼š</p>
        </div>
        
        <div class="daily-stats">
            <div class="stats-title">å­¦ä¹ è¿›åº¦</div>
            <div class="progress-bar">
                <div class="progress" id="progressBar" style="width: 0%"></div>
            </div>
            <div class="stats-content">
                <div>å·²å­¦ä¹ : <span id="wordsLearned">0</span> / <span id="totalWords">80</span> å•è¯</div>
                <div>ä»Šæ—¥å…³å¡: <span id="todayLevel">1</span></div>
                <div>æ­£ç¡®ç‡: <span id="accuracy">0</span>%</div>
            </div>
        </div>
    </div>

    <script>
        // ä¸€å¹´çº§è‹±è¯­å•è¯åº“ - 80ä¸ªå¸¸è§è¯æ±‡
        const grade1Words = [
            // åŠ¨ç‰©ç±»
            { english: "cat", chinese: "çŒ«", image: "ğŸ±" },
            { english: "dog", chinese: "ç‹—", image: "ğŸ¶" },
            { english: "fish", chinese: "é±¼", image: "ğŸŸ" },
            { english: "bird", chinese: "é¸Ÿ", image: "ğŸ¦" },
            { english: "rabbit", chinese: "å…”å­", image: "ğŸ°" },
            { english: "bear", chinese: "ç†Š", image: "ğŸ»" },
            { english: "lion", chinese: "ç‹®å­", image: "ğŸ¦" },
            { english: "tiger", chinese: "è€è™", image: "ğŸ¯" },
            { english: "elephant", chinese: "å¤§è±¡", image: "ğŸ˜" },
            { english: "monkey", chinese: "çŒ´å­", image: "ğŸ’" },
            
            // æ°´æœç±»
            { english: "apple", chinese: "è‹¹æœ", image: "ğŸ" },
            { english: "banana", chinese: "é¦™è•‰", image: "ğŸŒ" },
            { english: "orange", chinese: "æ©™å­", image: "ğŸŠ" },
            { english: "grape", chinese: "è‘¡è„", image: "ğŸ‡" },
            { english: "pear", chinese: "æ¢¨", image: "ğŸ" },
            { english: "peach", chinese: "æ¡ƒå­", image: "ğŸ‘" },
            { english: "watermelon", chinese: "è¥¿ç“œ", image: "ğŸ‰" },
            { english: "strawberry", chinese: "è‰è“", image: "ğŸ“" },
            { english: "pineapple", chinese: "è è", image: "ğŸ" },
            { english: "cherry", chinese: "æ¨±æ¡ƒ", image: "ğŸ’" },
            
            // é£Ÿç‰©ç±»
            { english: "egg", chinese: "é¸¡è›‹", image: "ğŸ¥š" },
            { english: "milk", chinese: "ç‰›å¥¶", image: "ğŸ¥›" },
            { english: "bread", chinese: "é¢åŒ…", image: "ğŸ" },
            { english: "rice", chinese: "ç±³é¥­", image: "ğŸš" },
            { english: "cake", chinese: "è›‹ç³•", image: "ğŸ°" },
            { english: "ice cream", chinese: "å†°æ·‡æ·‹", image: "ğŸ¦" },
            { english: "juice", chinese: "æœæ±", image: "ğŸ§ƒ" },
            { english: "water", chinese: "æ°´", image: "ğŸ’§" },
            { english: "tea", chinese: "èŒ¶", image: "ğŸµ" },
            { english: "candy", chinese: "ç³–æœ", image: "ğŸ¬" },
            
            // é¢œè‰²ç±»
            { english: "red", chinese: "çº¢è‰²", image: "ğŸ”´" },
            { english: "blue", chinese: "è“è‰²", image: "ğŸ”µ" },
            { english: "yellow", chinese: "é»„è‰²", image: "ğŸŸ¡" },
            { english: "green", chinese: "ç»¿è‰²", image: "ğŸŸ¢" },
            { english: "orange", chinese: "æ©™è‰²", image: "ğŸŸ " },
            { english: "purple", chinese: "ç´«è‰²", image: "ğŸŸ£" },
            { english: "pink", chinese: "ç²‰è‰²", image: "ğŸŒ¸" },
            { english: "black", chinese: "é»‘è‰²", image: "âš«" },
            { english: "white", chinese: "ç™½è‰²", image: "âšª" },
            { english: "brown", chinese: "æ£•è‰²", image: "ğŸŸ¤" },
            
            // æ•°å­—ç±»
            { english: "one", chinese: "ä¸€", image: "1ï¸âƒ£" },
            { english: "two", chinese: "äºŒ", image: "2ï¸âƒ£" },
            { english: "three", chinese: "ä¸‰", image: "3ï¸âƒ£" },
            { english: "four", chinese: "å››", image: "4ï¸âƒ£" },
            { english: "five", chinese: "äº”", image: "5ï¸âƒ£" },
            { english: "six", chinese: "å…­", image: "6ï¸âƒ£" },
            { english: "seven", chinese: "ä¸ƒ", image: "7ï¸âƒ£" },
            { english: "eight", chinese: "å…«", image: "8ï¸âƒ£" },
            { english: "nine", chinese: "ä¹", image: "9ï¸âƒ£" },
            { english: "ten", chinese: "å", image: "ğŸ”Ÿ" },
            
            // å­¦æ ¡ç”¨å“
            { english: "book", chinese: "ä¹¦", image: "ğŸ“–" },
            { english: "pencil", chinese: "é“…ç¬”", image: "âœï¸" },
            { english: "pen", chinese: "é’¢ç¬”", image: "ğŸ–Šï¸" },
            { english: "ruler", chinese: "å°ºå­", image: "ğŸ“" },
            { english: "bag", chinese: "ä¹¦åŒ…", image: "ğŸ’" },
            { english: "desk", chinese: "ä¹¦æ¡Œ", image: "ğŸª‘" },
            { english: "chair", chinese: "æ¤…å­", image: "ğŸª‘" },
            { english: "teacher", chinese: "è€å¸ˆ", image: "ğŸ‘©â€ğŸ«" },
            { english: "student", chinese: "å­¦ç”Ÿ", image: "ğŸ‘¨â€ğŸ“" },
            { english: "school", chinese: "å­¦æ ¡", image: "ğŸ«" },
            
            // å®¶åº­æˆå‘˜
            { english: "father", chinese: "çˆ¸çˆ¸", image: "ğŸ‘¨" },
            { english: "mother", chinese: "å¦ˆå¦ˆ", image: "ğŸ‘©" },
            { english: "brother", chinese: "å…„å¼Ÿ", image: "ğŸ‘¦" },
            { english: "sister", chinese: "å§å¦¹", image: "ğŸ‘§" },
            { english: "baby", chinese: "å®å®", image: "ğŸ‘¶" },
            { english: "family", chinese: "å®¶åº­", image: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" },
            { english: "friend", chinese: "æœ‹å‹", image: "ğŸ‘«" },
            { english: "boy", chinese: "ç”·å­©", image: "ğŸ‘¦" },
            { english: "girl", chinese: "å¥³å­©", image: "ğŸ‘§" },
            { english: "people", chinese: "äººä»¬", image: "ğŸ‘¥" },
            
            // æ—¥å¸¸ç”¨å“
            { english: "ball", chinese: "çƒ", image: "âš½" },
            { english: "doll", chinese: "å¨ƒå¨ƒ", image: "ğŸ‘§" },
            { english: "car", chinese: "å°æ±½è½¦", image: "ğŸš—" },
            { english: "house", chinese: "æˆ¿å­", image: "ğŸ " },
            { english: "bed", chinese: "åºŠ", image: "ğŸ›ï¸" },
            { english: "table", chinese: "æ¡Œå­", image: "ğŸª‘" },
            { english: "door", chinese: "é—¨", image: "ğŸšª" },
            { english: "window", chinese: "çª—æˆ·", image: "ğŸªŸ" },
            { english: "clock", chinese: "é’Ÿè¡¨", image: "â°" },
            { english: "phone", chinese: "ç”µè¯", image: "ğŸ“" }
        ];

        // æ¸¸æˆçŠ¶æ€å˜é‡
        let cards = [];
        let selectedCards = [];
        let matchedPairs = 0;
        let score = 0;
        let timeLeft = 60;
        let timer = null; // åˆå§‹åŒ–ä¸ºnull
        let gameStarted = false;
        let currentLevel = 1;
        let wordsLearnedToday = 0;
        let totalAttempts = 0;
        let correctAttempts = 0;
        let speechSynthesis;
        let gameCompleted = false;
        let continueCount = 2; // ç»§ç»­æ¸¸æˆæ¬¡æ•°
        
        // è®°å½•å·²ä½¿ç”¨çš„å•è¯
        let usedWords = new Set();
        
        // DOMå…ƒç´ 
        const gameBoard = document.getElementById('gameBoard');
        const timerDisplay = document.getElementById('timer');
        const scoreDisplay = document.getElementById('score');
        const levelDisplay = document.getElementById('level');
        const startButton = document.getElementById('start');
        const nextLevelButton = document.getElementById('nextLevel');
        const restartButton = document.getElementById('restart');
        const continueGameButton = document.getElementById('continueGame');
        const restartFromGameOverButton = document.getElementById('restartFromGameOver');
        const progressBar = document.getElementById('progressBar');
        const wordsLearnedDisplay = document.getElementById('wordsLearned');
        const todayLevelDisplay = document.getElementById('todayLevel');
        const accuracyDisplay = document.getElementById('accuracy');
        const totalWordsDisplay = document.getElementById('totalWords');
        const completionMessage = document.getElementById('completionMessage');
        const gameOverMessage = document.getElementById('gameOverMessage');
        const totalWordsLearnedDisplay = document.getElementById('totalWordsLearned');
        const finalScoreDisplay = document.getElementById('finalScore');
        const continueCountDisplay = document.getElementById('continueCount');
        const resetWordsButton = document.getElementById('resetWords');
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            cards = [];
            selectedCards = [];
            matchedPairs = 0;
            timeLeft = 60;
            gameStarted = false;
            gameCompleted = false;
            
            // æ¸…é™¤ä¹‹å‰çš„è®¡æ—¶å™¨
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // åˆå§‹åŒ–è¯­éŸ³åˆæˆ
            speechSynthesis = window.speechSynthesis;
            
            // æ¸…ç©ºæ¸¸æˆæ¿
            gameBoard.innerHTML = '';
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
            
            // éšè—æ¸¸æˆç»“æŸæ¶ˆæ¯
            gameOverMessage.style.display = 'none';
            gameBoard.style.display = 'grid';
            
            // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰å¯ç”¨å•è¯
            if (!hasAvailableWords()) {
                showCompletionMessage();
                return;
            }
            
            // éšæœºé€‰æ‹©8ä¸ªæœªä½¿ç”¨è¿‡çš„å•è¯
            const selectedWords = [];
            const availableWords = grade1Words.filter(word => !usedWords.has(word.english));
            
            // å¦‚æœå¯ç”¨å•è¯ä¸è¶³8ä¸ªï¼Œä½¿ç”¨æ‰€æœ‰å‰©ä½™å•è¯
            const wordsToSelect = Math.min(8, availableWords.length);
            
            for (let i = 0; i < wordsToSelect; i++) {
                const randomIndex = Math.floor(Math.random() * availableWords.length);
                const selectedWord = availableWords[randomIndex];
                
                // æ·»åŠ åˆ°å·²ä½¿ç”¨é›†åˆ
                usedWords.add(selectedWord.english);
                selectedWords.push(selectedWord);
                
                // ä»å¯ç”¨å•è¯ä¸­ç§»é™¤
                availableWords.splice(randomIndex, 1);
            }
            
            // åˆ›å»ºå¡ç‰‡æ•°ç»„ï¼ˆæ¯å¯¹å•è¯ä¸¤å¼ å¡ç‰‡ï¼‰
            selectedWords.forEach(word => {
                cards.push({ 
                    type: 'english', 
                    content: word.english, 
                    pairId: word.english,
                    image: word.image,
                    chinese: word.chinese
                });
                cards.push({ 
                    type: 'image', 
                    content: word.image, 
                    pairId: word.english,
                    image: word.image,
                    chinese: word.chinese
                });
            });
            
            // æ´—ç‰Œç®—æ³•
            shuffleCards();
            
            // åˆ›å»ºå¡ç‰‡å…ƒç´ 
            cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = `card card-type-${card.type}`;
                cardElement.dataset.index = index;
                cardElement.dataset.pairId = card.pairId;
                cardElement.dataset.type = card.type;
                
                // æ·»åŠ å‘éŸ³å›¾æ ‡
                const soundIcon = document.createElement('div');
                soundIcon.className = 'sound-icon';
                soundIcon.innerHTML = 'ğŸ”Š';
                
                // ç¡®ä¿æ¯ä¸ªå¡ç‰‡åªæ˜¾ç¤ºä¸€ç§è¯­è¨€
                if (card.type === 'english') {
                    cardElement.innerHTML = `
                        <div class="card-word">${card.content}</div>
                    `;
                } else {
                    cardElement.innerHTML = `
                        <div class="card-image">${card.image}</div>
                        <div class="card-word">${card.chinese}</div>
                    `;
                }
                
                cardElement.appendChild(soundIcon);
                cardElement.addEventListener('click', () => {
                    // æ’­æ”¾å‘éŸ³
                    playWordSound(card);
                    // é€‰æ‹©å¡ç‰‡è¿›è¡ŒåŒ¹é…
                    selectCard(cardElement, index);
                });
                gameBoard.appendChild(cardElement);
            });
            
            // æ›´æ–°ä»Šæ—¥å­¦ä¹ è¿›åº¦
            updateDailyStats();
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            startButton.disabled = false;
            nextLevelButton.style.display = 'none';
            startButton.style.display = 'block';
        }
        
        // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰å¯ç”¨å•è¯
        function hasAvailableWords() {
            return usedWords.size < grade1Words.length;
        }
        
        // æ˜¾ç¤ºå®Œæˆæ¶ˆæ¯
        function showCompletionMessage() {
            gameBoard.style.display = 'none';
            completionMessage.style.display = 'block';
            totalWordsLearnedDisplay.textContent = usedWords.size;
        }
        
        // æ˜¾ç¤ºæ¸¸æˆç»“æŸæ¶ˆæ¯
        function showGameOverMessage() {
            gameBoard.style.display = 'none';
            gameOverMessage.style.display = 'block';
            finalScoreDisplay.textContent = score;
            continueCountDisplay.textContent = continueCount;
            
            // å¦‚æœæ²¡æœ‰ç»§ç»­æ¬¡æ•°äº†ï¼Œéšè—ç»§ç»­æ¸¸æˆæŒ‰é’®
            if (continueCount <= 0) {
                continueGameButton.style.display = 'none';
            } else {
                continueGameButton.style.display = 'block';
            }
        }
        
        // æ’­æ”¾å•è¯å‘éŸ³
        function playWordSound(card) {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            const utterance = new SpeechSynthesisUtterance();
            
            if (card.type === 'english') {
                // æ’­æ”¾è‹±æ–‡å‘éŸ³
                utterance.text = card.content;
                utterance.lang = 'en-US';
                utterance.rate = 0.8; // ç¨å¾®æ…¢ä¸€ç‚¹ï¼Œé€‚åˆå­¦ä¹ 
            } else {
                // æ’­æ”¾ä¸­æ–‡å‘éŸ³
                utterance.text = card.chinese;
                utterance.lang = 'zh-CN';
                utterance.rate = 0.9;
            }
            
            utterance.volume = 1;
            utterance.pitch = 1;
            
            speechSynthesis.speak(utterance);
        }
        
        // æ´—ç‰Œç®—æ³•
        function shuffleCards() {
            for (let i = cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cards[i], cards[j]] = [cards[j], cards[i]];
            }
        }
        
        // é€‰æ‹©å¡ç‰‡
        function selectCard(cardElement, index) {
            // å¦‚æœæ¸¸æˆæœªå¼€å§‹æˆ–å¡ç‰‡å·²åŒ¹é…ï¼Œåˆ™å¿½ç•¥ç‚¹å‡»
            if (!gameStarted || cardElement.classList.contains('matched') || gameCompleted) {
                return;
            }
            
            // å¦‚æœå·²ç»é€‰ä¸­äº†ä¸¤å¼ å¡ç‰‡ï¼Œå…ˆæ¸…é™¤é€‰æ‹©
            if (selectedCards.length >= 2) {
                selectedCards.forEach(card => {
                    card.element.classList.remove('selected');
                });
                selectedCards = [];
            }
            
            // é€‰ä¸­å½“å‰å¡ç‰‡
            cardElement.classList.add('selected');
            selectedCards.push({ element: cardElement, index });
            
            // å¦‚æœé€‰ä¸­äº†ä¸¤å¼ å¡ç‰‡ï¼Œæ£€æŸ¥æ˜¯å¦åŒ¹é…
            if (selectedCards.length === 2) {
                totalAttempts++;
                checkForMatch();
            }
        }
        
        // æ£€æŸ¥å¡ç‰‡æ˜¯å¦åŒ¹é…
        function checkForMatch() {
            const card1 = cards[selectedCards[0].index];
            const card2 = cards[selectedCards[1].index];
            
            // æ£€æŸ¥æ˜¯å¦åŒ¹é…ï¼ˆåŒä¸€å•è¯å¯¹ä¸”ä¸€ä¸ªæ˜¯è‹±è¯­ä¸€ä¸ªæ˜¯å›¾ç‰‡ï¼‰
            if (card1.pairId === card2.pairId && card1.type !== card2.type) {
                // åŒ¹é…æˆåŠŸ
                correctAttempts++;
                setTimeout(() => {
                    selectedCards.forEach(card => {
                        card.element.classList.add('matched');
                        card.element.classList.remove('selected');
                    });
                    
                    selectedCards = [];
                    matchedPairs++;
                    score += 10;
                    wordsLearnedToday++;
                    updateDisplay();
                    updateDailyStats();
                    
                    // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
                    if (matchedPairs === cards.length / 2) {
                        gameCompleted = true;
                        // åœæ­¢è®¡æ—¶å™¨
                        if (timer) {
                            clearInterval(timer);
                            timer = null;
                        }
                        createFireworks();
                        setTimeout(() => {
                            // æ˜¾ç¤ºä¸‹ä¸€å…³æŒ‰é’®
                            nextLevelButton.style.display = 'block';
                            startButton.style.display = 'none';
                        }, 1000);
                    }
                }, 500);
            } else {
                // åŒ¹é…å¤±è´¥
                setTimeout(() => {
                    selectedCards.forEach(card => {
                        card.element.classList.remove('selected');
                    });
                    
                    selectedCards = [];
                }, 1000);
            }
        }
        
        // åˆ›å»ºç¤¼èŠ±æ•ˆæœ
        function createFireworks() {
            const colors = ['#ff6b6b', '#ffd166', '#06d6a0', '#118ab2', '#ef476f', '#5ce1e6'];
            const fireworkCount = 30;
            
            for (let i = 0; i < fireworkCount; i++) {
                const firework = document.createElement('div');
                firework.className = 'firework';
                
                // éšæœºé¢œè‰²
                const color = colors[Math.floor(Math.random() * colors.length)];
                firework.style.backgroundColor = color;
                
                // éšæœºä½ç½®
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                firework.style.setProperty('--x', `${x}px`);
                firework.style.setProperty('--y', `${y}px`);
                
                // éšæœºå¤§å°å’ŒåŠ¨ç”»å»¶è¿Ÿ
                const size = Math.random() * 8 + 3;
                const delay = Math.random() * 0.5;
                
                firework.style.width = `${size}px`;
                firework.style.height = `${size}px`;
                firework.style.animation = `firework 1s ease-out ${delay}s forwards`;
                
                document.body.appendChild(firework);
                
                // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
                setTimeout(() => {
                    firework.remove();
                }, 1500);
            }
        }
        
        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            if (gameStarted) return;
            
            gameStarted = true;
            startButton.disabled = true;
            
            // æ¸…é™¤ä¹‹å‰çš„è®¡æ—¶å™¨
            if (timer) {
                clearInterval(timer);
            }
            
            // å¼€å§‹è®¡æ—¶
            timer = setInterval(() => {
                timeLeft--;
                updateDisplay();
                
                if (timeLeft <= 10) {
                    timerDisplay.classList.add('timer-warning');
                }
                
                if (timeLeft <= 0) {
                    endGame(false);
                }
            }, 1000);
        }
        
        // ç»“æŸæ¸¸æˆ
        function endGame(isWin) {
            // åœæ­¢è®¡æ—¶å™¨
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            gameStarted = false;
            timerDisplay.classList.remove('timer-warning');
            
            if (isWin) {
                score += timeLeft * 2; // å‰©ä½™æ—¶é—´å¥–åŠ±
                updateDisplay();
            } else {
                // æ—¶é—´åˆ°ï¼Œæ˜¾ç¤ºæ¸¸æˆç»“æŸç•Œé¢
                showGameOverMessage();
            }
        }
        
        // ç»§ç»­æ¸¸æˆ
        function continueGame() {
            if (continueCount > 0) {
                continueCount--;
                timeLeft = 30; // ç»§ç»­æ¸¸æˆç»™30ç§’æ—¶é—´
                gameStarted = true;
                gameOverMessage.style.display = 'none';
                gameBoard.style.display = 'grid';
                
                // æ¸…é™¤ä¹‹å‰çš„è®¡æ—¶å™¨
                if (timer) {
                    clearInterval(timer);
                }
                
                // é‡æ–°å¼€å§‹è®¡æ—¶
                timer = setInterval(() => {
                    timeLeft--;
                    updateDisplay();
                    
                    if (timeLeft <= 10) {
                        timerDisplay.classList.add('timer-warning');
                    }
                    
                    if (timeLeft <= 0) {
                        endGame(false);
                    }
                }, 1000);
            }
        }
        
        // è¿›å…¥ä¸‹ä¸€å…³
        function nextLevel() {
            currentLevel++;
            initGame();
        }
        
        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            timerDisplay.textContent = timeLeft;
            scoreDisplay.textContent = score;
            levelDisplay.textContent = currentLevel;
        }
        
        // æ›´æ–°æ¯æ—¥ç»Ÿè®¡
        function updateDailyStats() {
            // è®¡ç®—æ€»å•è¯æ•°
            const totalWordsCount = grade1Words.length;
            const learnedWordsCount = usedWords.size;
            
            // è®¡ç®—å­¦ä¹ è¿›åº¦
            const progress = Math.min(100, Math.floor((learnedWordsCount / totalWordsCount) * 100));
            progressBar.style.width = `${progress}%`;
            
            // è®¡ç®—æ­£ç¡®ç‡
            const accuracy = totalAttempts > 0 ? Math.floor((correctAttempts / totalAttempts) * 100) : 0;
            
            wordsLearnedDisplay.textContent = learnedWordsCount;
            totalWordsDisplay.textContent = totalWordsCount;
            todayLevelDisplay.textContent = currentLevel;
            accuracyDisplay.textContent = accuracy;
        }
        
        // é‡ç½®å·²å­¦å•è¯
        function resetLearnedWords() {
            usedWords = new Set();
            currentLevel = 1;
            score = 0;
            wordsLearnedToday = 0;
            totalAttempts = 0;
            correctAttempts = 0;
            continueCount = 2; // é‡ç½®ç»§ç»­æ¸¸æˆæ¬¡æ•°
            
            // æ¸…é™¤è®¡æ—¶å™¨
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            completionMessage.style.display = 'none';
            gameOverMessage.style.display = 'none';
            gameBoard.style.display = 'grid';
            initGame();
        }
        
        // äº‹ä»¶ç›‘å¬
        startButton.addEventListener('click', startGame);
        nextLevelButton.addEventListener('click', nextLevel);
        restartButton.addEventListener('click', resetLearnedWords);
        continueGameButton.addEventListener('click', continueGame);
        restartFromGameOverButton.addEventListener('click', resetLearnedWords);
        resetWordsButton.addEventListener('click', resetLearnedWords);
        
        // åˆå§‹åŒ–æ¸¸æˆ
        initGame();
    </script>
</body>
</html>